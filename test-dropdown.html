<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>下拉框测试</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 50px;
            background: #f5f5f5;
        }
        
        .test-container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            max-width: 400px;
            margin: 0 auto;
        }
        
        .mode-selector {
            display: flex;
            align-items: center;
            margin: 20px 0;
            position: relative;
        }
        
        .mode-title {
            font-size: 14px;
            color: #666;
            margin-right: 12px;
            font-weight: 500;
        }
        
        .mode-dropdown {
            position: relative;
            display: inline-block;
        }

        .mode-dropdown-btn {
            display: flex;
            align-items: center;
            background: rgba(0,0,0,0.04);
            border: 1px solid rgba(0,0,0,0.03);
            border-radius: 18px;
            padding: 8px 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            color: #374151;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            min-width: 120px;
        }

        .mode-dropdown-btn:hover {
            background: rgba(0,0,0,0.06);
            box-shadow: 0 2px 5px rgba(0,0,0,0.08);
        }

        .selected-mode-icon {
            margin-right: 8px;
            font-size: 16px;
        }

        .dropdown-arrow {
            margin-left: auto;
            font-size: 12px;
            transition: transform 0.3s ease;
        }

        .mode-dropdown-btn.active .dropdown-arrow {
            transform: rotate(180deg);
        }

        .mode-dropdown-content {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            min-width: 180px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border: 1px solid rgba(0,0,0,0.05);
            z-index: 1000;
            padding: 8px 0;
            display: none;
            animation: fadeIn 0.2s ease;
            margin-top: 4px;
        }

        .mode-dropdown-content.show {
            display: block;
        }

        .mode-option {
            padding: 12px 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            font-size: 14px;
            color: #333;
        }

        .mode-option:hover {
            background: rgba(0,0,0,0.04);
        }

        .mode-option.active {
            background: linear-gradient(135deg, #6e8efb, #a777e3);
            color: white;
        }

        .mode-option .mode-icon {
            margin-right: 10px;
            font-size: 16px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .debug-info {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h2>模式选择下拉框测试</h2>
        
        <div class="mode-selector">
            <span class="mode-title">选择模式：</span>
            <div class="mode-dropdown">
                <button class="mode-dropdown-btn" id="modeDropdownBtn">
                    <span class="selected-mode-icon">🌟</span>
                    <span class="selected-mode-name">通用</span>
                    <span class="dropdown-arrow">▼</span>
                </button>
                <div class="mode-dropdown-content" id="modeDropdownContent">
                    <div class="mode-option active" data-mode="general">
                        <span class="mode-icon">🌟</span>
                        <span class="mode-name">通用</span>
                    </div>
                    <div class="mode-option" data-mode="business">
                        <span class="mode-icon">💼</span>
                        <span class="mode-name">商业</span>
                    </div>
                    <div class="mode-option" data-mode="drawing">
                        <span class="mode-icon">🎨</span>
                        <span class="mode-name">绘画</span>
                    </div>
                    <div class="mode-option" data-mode="academic">
                        <span class="mode-icon">📚</span>
                        <span class="mode-name">学术</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="debug-info" id="debugInfo">
            <strong>调试信息：</strong><br>
            当前模式: <span id="currentMode">general</span><br>
            点击次数: <span id="clickCount">0</span><br>
            下拉框状态: <span id="dropdownStatus">隐藏</span>
        </div>
    </div>

    <script>
        let currentMode = 'general';
        let clickCount = 0;
        
        // 获取元素
        const modeDropdownBtn = document.getElementById('modeDropdownBtn');
        const modeDropdownContent = document.getElementById('modeDropdownContent');
        const modeOptions = document.querySelectorAll('.mode-option');
        const selectedModeIcon = document.querySelector('.selected-mode-icon');
        const selectedModeName = document.querySelector('.selected-mode-name');
        
        // 调试信息元素
        const debugInfo = document.getElementById('debugInfo');
        const currentModeSpan = document.getElementById('currentMode');
        const clickCountSpan = document.getElementById('clickCount');
        const dropdownStatusSpan = document.getElementById('dropdownStatus');
        
        function updateDebugInfo() {
            currentModeSpan.textContent = currentMode;
            clickCountSpan.textContent = clickCount;
            dropdownStatusSpan.textContent = modeDropdownContent.classList.contains('show') ? '显示' : '隐藏';
        }
        
        console.log('测试页面加载完成');
        console.log('元素检查:', {
            modeDropdownBtn: modeDropdownBtn ? '存在' : '不存在',
            modeDropdownContent: modeDropdownContent ? '存在' : '不存在',
            modeOptions: modeOptions.length + '个选项'
        });
        
        // 点击下拉按钮
        if (modeDropdownBtn && modeDropdownContent) {
            modeDropdownBtn.addEventListener('click', function(e) {
                clickCount++;
                console.log('点击下拉按钮，第' + clickCount + '次');
                e.stopPropagation();
                this.classList.toggle('active');
                modeDropdownContent.classList.toggle('show');
                updateDebugInfo();
            });
        }
        
        // 点击选项
        modeOptions.forEach(option => {
            option.addEventListener('click', function() {
                const mode = this.getAttribute('data-mode');
                const icon = this.querySelector('.mode-icon').textContent;
                const name = this.querySelector('.mode-name').textContent;
                
                console.log('选择模式:', mode);
                
                // 更新选中状态
                modeOptions.forEach(opt => opt.classList.remove('active'));
                this.classList.add('active');
                
                // 更新显示
                selectedModeIcon.textContent = icon;
                selectedModeName.textContent = name;
                currentMode = mode;
                
                // 隐藏下拉菜单
                modeDropdownContent.classList.remove('show');
                modeDropdownBtn.classList.remove('active');
                
                updateDebugInfo();
            });
        });
        
        // 点击页面其他区域关闭
        document.addEventListener('click', function(e) {
            if (modeDropdownContent && modeDropdownContent.classList.contains('show')) {
                console.log('点击页面其他区域，关闭下拉菜单');
                modeDropdownContent.classList.remove('show');
                modeDropdownBtn.classList.remove('active');
                updateDebugInfo();
            }
        });
        
        // 防止点击下拉内容时关闭
        if (modeDropdownContent) {
            modeDropdownContent.addEventListener('click', function(e) {
                console.log('点击下拉内容，阻止冒泡');
                e.stopPropagation();
            });
        }
        
        // 初始化调试信息
        updateDebugInfo();
    </script>
</body>
</html>
